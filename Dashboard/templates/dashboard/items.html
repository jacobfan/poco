{% extends "dashboard/new_base.html" %}
{% block mvc-script %}
<script src="{{STATIC_URL}}js/models/items.js" type="text/javascript" ></script>
<script src="{{STATIC_URL}}js/views/items.js" type="text/javascript" ></script>
<script src="{{STATIC_URL}}js/controllers/items.js" type="text/javascript" ></script>
<script src="{{STATIC_URL}}js/libs/bootstrap/js/bootstrap-twipsy.js" type="text/javascript" ></script>
<script src="{{STATIC_URL}}js/libs/bootstrap/js/bootstrap-popover.js" type="text/javascript" ></script>
{% endblock %}
{% block head %}
<script type="text/javascript">
$(document).ready(function(){
  App.initialize(App.Routers.Items);
});
</script>
<style type="text/css">
.popover .inner {
  background-color: rgba(100, 100, 100, 0.8);
  width: 230px;
}
.popover .inner img{
  width: 200px;
}
.popover.left .arrow{
  border-left: 5px solid rgba(100, 100, 100, 0.8);
}
</style>
{% endblock %}
{% block site-nav %}
<ul class="nav">
  <li><a href="/report/{{api_key}}/#">推荐统计</a></li>
  <li class="active"><a href="/items/{{api_key}}/#">商品管理</a></li>
</ul>
{% endblock %}
{% block container %}
<div class="container-fluid">

    <div id="sidebar_nav" class="sidebar">
      <div class="well">
        <h5>商品管理</h5>
        <ul>
          <li><a href="#">商品列表</a></li>
          <li><a href="#upg">编辑商品分类组别</a></li>
        </ul>
      </div>
    </div>
    <div id="content" class="content">
      <div>
        <a href="#">商品管理</a>
        <span>&gt;&gt;</span>
        <span id="items_nav"></span>
      </div>
      <hr />
      <!--
      <div id="pagination" class="pagination">
        <form id="item-search" class="pull-right"  action="javascript:return true;">
        <input id="item-search-text" type="text" value="" placeholder="输入商品名称">
        <button id="item-search-btn" type="submit" class="btn primary">搜索</button>
        </form>
      </div>
      <div id="item-info">
      </div>
      -->
    </div>
    <script id="item-template" type="text/template">
      <button class="btn info" onclick="window.history.back()">返回</button><br />
      <table class="zebra-striped">
      <%= item_name %>
    </script>
    <script id="pagination-template" type="text/template">
      <div id="pagination" class="pagination">
        <form id="item-search" class="pull-right"  action="javascript:return true;">
        <input id="item-search-text" type="text" value="" placeholder="输入商品名称">
        <button id="item-search-btn" type="submit" class="btn primary">搜索</button>
        </form>
      </div>
    </script>
    <script id="pagination-page-template" type="text/template">
      <ul>
      <% if(pages > 1) { %>
          <li><a rel="link" href="#page/1">&lt;&lt;</a></li>
        <% if(prev) { %>
          <li class="pre"><a rel="link" href="#page/<%= prev %>">上一页</a></li>
        <% } else { %>
          <li class="prev disabled"><a href="javascript:void(0);">上一页</a></li>
        <% } %>
        <% 
          var pagi_range = pages > 5 ? 5 : pages;
          var from = Math.floor((page_num-1)/pagi_range)*pagi_range + 1;
          var to = from + pagi_range - 1;
          if(to > pages)
          {
            to = pages;
            from = to - pagi_range + 1;
          }
          for(var i=from; i<=to; i ++){ %>
            <li<% if(page_num == i) { %> class="active"<% } %>><a rel="link" href="#page/<%= i %>"><%= i %></a></li>
        <% } %>
        <% if(next) { %>
          <li class="pre"><a rel="link" href="#page/<%= next %>">下一页</a></li>
        <% } else { %>
          <li class="pre disabled"><a href="javascript:void(0);">下一页</a></li>
        <% } %>
          <li class="pre"><a rel="link" href="#page/<%= pages %>">&gt;&gt;</a></li>
      <% } %>
      <li class="disabled"><a href="javascript:void(0);">
      <% if(total == 0) { %>
        没有记录
        <% } else { %>
        共<%= total %>件<% if(total > 1) { %> / <%= range[0] %>~<%= range[1] %><% } %>
        <% } %>
        </a>
      </li>
      </ul>
    </script>
    <script id="items-template" type="text/template">
      <div id="items-info" style="margin-bottom:55px;">
      <% if (items.length > 0) { %>
      <table class="zebra-striped">
        <thead>
          <tr>
            <th>商品名称</th>
            <th style="width:150px">价格</th>
          </tr>
        </thead>
        <tbody>
        <% _.each(items, function(item){ %>
          <tr>
            <td>
            <a href="#id/<%= item.item_id %>" rel="popover" data-content="<img src='<%= item.image_link %>'>" data-original-title="#<%= item.item_id %>"><%= item.item_name %></a></item>
            <td><%= item.price %></item>
          </tr>
        <% }); %>
        </tbody>
        </table>
      </div>
      <% } %>
    </script>
    <input type="hidden" name="api_key" id="api_key" value="{{api_key}}" />
    <input type="hidden" name="search_name" id="search_name" value="" />
  </div>
{% endblock %}
